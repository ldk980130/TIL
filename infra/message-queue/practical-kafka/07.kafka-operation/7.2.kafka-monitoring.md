# 7.2 모니터링 시스템 구성

## 7.2.1 애플리케이션으로서 카프카의 로그 관리와 분석

- 카프카는 발생하는 모든 로그를 브로커의 로컬 디스크에 기록하고 있다.
- 카프카는 로그 관리를 위해 자바 기반 로깅 유틸리티인 아파치 log4j를 이용한다.

| 로그 레벨 | 설명 |
| --- | --- |
| TRACE | DEBUG보다 상세 로그를 기록 |
| DEBUG | 내부 애플리케이션 상황에 대해 기록 |
| INFO | 로그 레벨의 기본값이며 일반적인 정보 수준의 로그를 기록 |
| WARN | INFO 로그 레벨보다 높은 개념으로 경고 수준의 로그를 기록 |
| ERROR | 경고 수준을 넘어 런타임 에러나 예상하지 못한 에러 로그를 기록 |
| FINAL | 로그 레벨 중 최종 단계로 심각한 애플리케이션 중지 등의 로그를 기록 |

- 카프카에서 제공하는 log4j 설정 변경을 통해 관리자는 언제든 로그 레벨을 변경할 수 있다.
    - 리눅스 명령어를 통해 log4j.properties 파일을 편집하고 브로커를 재시작하면 된다.

```bash
# 예시: 전체 Kafka 패키지 로깅 레벨을 DEBUG로 변경
log4j.logger.kafka=DEBUG
log4j.logger.org.apache.kafka=DEBUG
```

- 주의할 점
    - 로그 레벨을 INFO에서 DEBUG, TRACE 등으로 낮출 경우 생각보다 많은 로그가 기록된다.
    - 모든 로그는 로컬 디스크에 기록되기에 브로커 여유 디스크 공간이 충분한지 확인해야 한다.
- 카프카가 각 로그 파일들에 어떤 정보를 기록하는지는 다음과 같다.

| 로그 파일 이름 | 설명 |
| --- | --- |
| server.log | 브로커 설정 정보와 정보성 로그 등을 기록. 브로커 재시작 시 브로커 옵션 정보가 기록됨 |
| state-change.log | 컨트롤러로부터 받은 정보를 기록 |
| kafka-request.log | 클라이언트로부터 받은 정보를 기록 |
| log-cleaner.log | 로그 컴팩션 동작들을 기록 |
| controller.log | 컨트롤러 관련 정보를 기록 |
| kafka-authorizer.log | 인증과 관련된 정보를 기록 |

