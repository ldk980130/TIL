# 13장 증권 거래소

## 1단계: 문제 이해 및 설계 범위 확정

- 기능 요구사항
    - 간단히 주식만 거래한다고 가정
        - 새 주문
        - 체결되지 않은 주문 취소
    - 주문 유형은 지정가 주문만 가능
    - 시간 내 거래 처리
    - 거래소는 규제 시설이므로 위험성 점검이 가능해야 한다.
        - ex) 한 사용자가 하루에 거래할 수 있는 애플 주식을 백만 주 이하로 제한하는 규칙이 있다고 할 때 이를 위반한 거래가 있는지 점검
    - 사용자 지갑 관리
- 비기능 요구사항
    - 가용성: 최소 99.99%
    - 결함 내성: 빠른 복구 메커니즘이 필요
    - 지연 시간
        - 왕복 지연 시간이 밀리초 수준이어야 한다.
        - p99 지연 시간이 중요
    - 보안
        - 거래소는 계좌 신설 전에 사용자 신원 확인을 위한 KYC 확인을 수행
        - DDoS 공격 방지 장치 구비
- 개략적 규모 추정
    - 100가지 주식
    - 하루 10억 건 주문
    - 월~금 오전 9시 30분 ~ 16시까지 (6.5시간)
    - QPS: 10억 / (6.5 * 3600) =~ 43,000
    - 최대 QPS: 5 * QPS = 215,000
        - 거래량은 장 시작 직후, 마감 직전이 훨씬 높다.
