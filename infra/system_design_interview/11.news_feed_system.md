# 11장 뉴스 피드 시스템 설계
- 뉴스 피드란?

> 뉴스 피드는 여러분의 홈 페이지 중앙에 지속적으로 업데이트되는 스토리들로, 사용자 상태 정보 업데이트, 사진, 비디오, 링크, 앱 활동, 그리고 여러분이 페이스북에서 팔로하는 사람들, 페이지, 또는 그룹으로부터 나오는 ‘좋아요’ 등을 포함한다 <페이스북 도움말 페이지>
>

## 뉴스 피드 시스템 개략적 설계안

- 설계안은 다음 두 가지 부분으로 나뉘어 있다.
    - 피드 발행: 사용자가 스토리를 포스팅하면 해당 데이터를 캐시와 데이터베이스에 기록
        - 새 포스팅은 친구의 뉴스 피드에도 전송된다.
    - 뉴스 피드 생성: 뉴스 피드는 모든 친구의 포스팅을 시간 흐름 역순으로 모아서 만든다고 가정

### 뉴스 피드 API

- 상태 정보를 업데이트하거나 뉴스 피드를 가져오거나 친구를 추가하는 등의 작업을 수행

**피드 발행 API**

- 새 스토리를 포스팅하기 위한 API
- HTTP POST 형태로 요청
    - `POST /v1/me/feed`
    - 인자: 바디(포스팅 내용), Authorization 헤더

**피드 읽기 API**

- 뉴스 피드를 가져오는 API
    - `GET /v1/me/feed`
    - 인자: Authorization 헤더

### 피드 발행
<img width="500" height="1000" src="https://github.com/ldk980130/TIL/assets/78652144/c30ee105-81d8-42ae-9b0c-e6e5483aa374">

- 사용자: 모바일 앱이나 브라우저에서 새 포스팅을 올리는 주체
- 로드 밸런서: 트래픽을 웹 서버들로 분산
- 웹 서버: HTTP 요청을 내부 서비스로 중계하는 역할 담당
- 포스팅 저장 서비스: 새 포스팅을 DB와 캐시에 저장
- 포스팅 전송 서비스: 새 포스팅을 친구 뉴스 피드에 push
    - 피드 데이터는 캐시에 보관하여 빠르게 읽을 수 있도록 한다.
- 알림 서비스: 친구들에게 새 포스팅이 올라왔음을 알림

### 뉴스 피드 생성
<img width="500" height="1000" src="https://github.com/ldk980130/TIL/assets/78652144/28e37b9a-2a4d-4996-b33c-7566076c9b90">

- 사용자: 뉴스 피드를 읽는 주체
- 로드 밸런서: 트래픽을 웹 서버들로 분산
- 웹 서버: 트래픽을 뉴스 피드 서비스로 전송
- 뉴스 피드 서비스: 캐시에서 뉴스 피드를 가져오는 서비스
- 뉴스 피드 캐시: 뉴스 피드를 렌더링할 때 필요한 피드 ID를 보관
