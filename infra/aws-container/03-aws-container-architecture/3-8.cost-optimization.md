# 3-8 비용 최적화 설계

## 비용 최적화 아이디어

- 클라우드 서비스 이용 방법에 따라선 클라우드가 더 비쌀 수도 있기에 비용 최적화는 중요하다.
- Well-Architected 프레임워크의 ‘비용 최적화 원칙’
    - 클라우드 재무 관리 구현 - 조직의 비용 의식을 개선해 나감
    - 소비 모델 도입 - 필요할 때 필요한 자원만을 이용
    - 전반적인 효율성 측정 - 실제 필요한 비용을 측정해 비용 절감
    - 획일적인 업무 부담에 대한 비용 지출 중단 - 관리형 서비스를 이용해 운영 부담을 낮춤
    - 지출 분석 및 귀속 - 비용 식별을 통한 합리적 비용 절감
- ECS/Fargate에서는 ‘소비 모델 도입’이 주요 주제다.
    - ECS 태스크 수와 자원 크기 산정
    - Compute Saving Plans 활용
    - ECR 컨테이너 이미지 유지 보수
    - 개발 스테이징 환경의 ECS 실행 시간대 조절
    - Fargate Spot 활용
    - 컨테이너 이미지 크기 줄이기

## ECS 태스크 수와 자원 크기 선정

- ECS/Fargate 이용 시 비용 최적화의 기본
    - 애플리케이션 실행에 필요한 충분한 자원량을 결정하는 것

## Compute Savings Plan 활용

- Compute Savings Plans
    - 지정한 자원을 1년 또는 3년간 약정 이용하는 것을 조건으로 저렴한 요금을 제공하는 모델
    - 약정 자원 사용량을 초과해 사용한 부분은 일반 요금이 적용된다.
- 워크로드 특성을 파악하고 활용을 검토하자

## ECR 컨테이너 이미지 관리

- ECR의 이미지를 적절히 관리하는 것도 비용을 아끼는 데 도움이 된다.
    - ECR은 저장한 컨테이너 이미지 크게에 비례해 요금이 발생한다.

## 개발, 스테이징 환경의 ECS 태스크 실행 시간대 조절

- 개발 환경이나 스테이징 환경은 24시간 내내 이용할 필요가 없는 경우가 많기에 실행 시간대를 정해두면 요금을 절약할 수 있다.
- CloudWatch Events에서 Lambda를 실행시켜 태스크 수를 변경하는 방법으로 야간에 ECS 태스크 정지도 가능하다.

