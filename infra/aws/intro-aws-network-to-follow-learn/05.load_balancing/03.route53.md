# 03. Route 53

## 3.1 DNS (Domain Name System)

### 3.1.1 DNS 개요

- **DNS는 복잡한 주소 체계(IPv4)를 문자 형태의 도메인 네임으로 매핑하여 연결하는 서비스**이다.
    - 10진수 4자리로 이루어진 IPv4 주소는 기억하고 숙지하기가 어렵다.

### 3.1.2 DNS 서버 분류

DNS를 통해 서비스를 수행하려면 DNS 서버가 필요한데 4가지 유형으로 분류된다.

- **DNS 해석기 (DNS Resolver)**
    - 클라이언트와 네임 서버의 중계자 역할
    - 클라이언트의 요청을 네임 서버로 전달하고 DNS 응답을 클라이언트에게 전달한다.
- **루트 네임 서버 (Root Name Server)**
    - DNS 서버의 최상위 네임 서버
    - DNS 요청에 대해 적절한 TLD 네임 서버 정보를 반환
- **TLD 네임 서버 (Top Level Domain Name Server)**
    - `.com`, `.net`과 같은 최상위 도메인에 대한 네임 서버
    - 해당 영역에 포함되는 모든 도메인 이름 정보를 유지한다.
    - DNS 요청에 대해 권한 있는 네임 서버를 지정하여 반환한다.
- **권한 있는 네임 서버 (Authoritative Name Server)**
    - DNS 해석기가 TLD 네임 서버로부터 응답을 받으면 해당 응답을 권한 있는 네임 서버로 보낸다.
    - 요청한 도메인 주소에 대한 IP 주소를 확인하는 마지막 단계
- DNS 해석기가 루트 네임 서버, TLD 네임 서버, 권한 있는 네임 서버를 차례로 방문하여 최종 IP를 알아낸는 구조

### 3.1.3 DNS 레코드 유형

**DNS 레코드는 도메인 관한 설정을 하기 위해 사용되는 일련의 문자들이다.**

| 레코드 | 의미 | 레코드  | 의미 |
| --- | --- | --- | --- |
| A | IPv4 주소 매핑 | NS | 도메인 네임 서버 식별 |
| AAAA | IPv6 주소 매핑 | SOA | 도메인 영역을 표시하는 역할 |
| CNAME | 도메인 이름의 별칭을 만듦 | SRV | 도메인 서비스 이용 가능 여부 식별 |
| MX | 이메일 서버 지정 | TXT | 텍스트 매핑 |

## 3.2 Route 53 소개

### 3.2.1 Route 53 개요

**Route 53은 AWS에서 제공하는 관리형 DNS 서비스이다.**

- **도메인 이름 등록**
    - Route 53을 통해 도메인 이름을 등록할 수 있다.
    - Route 53은 등록 대행소로서 TLD 네임 서버에 전파해 해당 도메인 이름을 사용할 수 있도록 한다.
- **호스팅 영역**
    - DNS 관리를 할 수 있는 호스팅 영역이 자동으로 생성된다.
    - 호스팅 영역이 생성되면 네임 서버가 생성되어 DNS 요청에 응답한다.
- **레코드**
    - 호스팅 영역에 레코드를 작성할 수 있다.
    - 레코드를 생성할 때 다양한 라우팅 정책을 수립할 수 있다.

### 3.2.2 Route 53 라우팅 정책

라우팅 정책이란 DNS 요청에 대한 응답 방식을 말한다.

- **단순 라우팅**
    - 도메인에 대해 특정 하나의 리소스를 지정
    - 레코드 값은 여러 개를 입력할 수 있으나 하나의 값만 랜덤하게 응답
- **가중치 기반 라우팅**
    - 도메인에 대해 다수 리소스를 지정하고 값 비중을 두고 라우팅을 한다.
    - 가중치 값은 0~255 사이이다. (0이면 응답하지 않음)
    - [대상 가중치 / 전체 가중치 합]을 통해 비중을 부여한다.
- **지연 시간 기반 라우팅**
    - 여러 리전에 리소스가 있고 최상의 지연 시간을 제공하는 리전으로 라우팅한다.
- **장애 조치 라우팅 정책**
    - 레코드값 중 일부를 액티브를 지정하고 대상으로 라우팅을 한다.
    - 주기적인 상태 확인을 통해 액티브가 통신 불가일 경우 패시브 대상을 액티브 대상으로 변경하여 라우팅한다.
- **지리 위치 라우팅**
    - DNS에 질의하는 사용자의 로컬 DNS 서버 IP 위치를 기반하여 가장 인접한 리전의 리소스 대상으로 라우팅
- **지리 근접 라우팅**
    - 지리 위치 라우팅과 동일한 라우팅 기법
    - 바이어스라는 값을 조정하여 근접 영역의 영향도를 조정
- **다중값 응답 라우팅**
    - Route 53이 DNS 질의에 대해 다수 값을 반환하도록 구성할 수 있다.
    - 최대 8개

### 3.2.3 Route 53 주요 기능

- **도메인 등록**
- **상태 확인 및 모니터링**
- **DNS 장애 조치**
- **라우팅 정책**
- **Alias (별칭)**
    - AWS 서비스의 도메인 이름에 별칭을 지정할 수 있는 기능
    - ELB, CloudFront, S3 버킷 등에 매핑 가능
- **Route 53 Resolver**
    - Amazon Route 53 프라이빗 호스팅 영역과 온프레미스 DNS 서버 간 도메인 질의가 가능하다.
    - 조건부 전달 규칙 및 DNS 엔드포인트를 생성하는 것으로 가능
- **VPC 용 프라이빗 DNS**
    - DNS 데이터를 퍼블릭 인터넷에 노출하지 않고 도메인 이름을 관리
