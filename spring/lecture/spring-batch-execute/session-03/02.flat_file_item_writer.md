# FlatFileItemWriter

## FlatFileItemWriter

- 대량의 파일 쓰기 작업을 효율적으로 처리할 수 있다.
- `FlatFileItemReader`와는 반대로 도메인 객체를 문자열로 변환해서 쓴다.
- 파일 쓰기 작업은 크게 두 단계로 나뉜다.
    - 필드 추출 - `FieldExtrator`
    - 문자열 결합 - `LineAggregator`

## FieldExtractor

- 객체 `T`를 `Object`의 배열 형태로 반환한다.

```java
public interface FieldExtractor<T> {
    Object[] extract(T item);
}
```

- `FieldExtractor`도 스프링에서 기본 구현체를 제공한다.
    - `BeanWrapperFieldExtractor`
        - Java bean 객체로부터 필드를 추출
        - 객체 프로퍼티 이름을 기반으로 `getter` 메서드로 필드값을 추출
    - `RecordFieldExtractor`
        - Java Record 객체에서 필드를 추출
        - 레코드 컴포넌트의 accessor 메서드를 호출해 값을 가져온다.
    - 도메인 객체 타입에 따라 두 구현체 중 하나가 자동으로 선택된다.

## LineAggregator

- `T` 도메인 객체를 받아 문자열로 결합하여 반환한다.

```java
public interface LineAggregator<T> {
    String aggregate(T item);
}
```

- 파일 읽기 때와 마찬가지로 구분자 기반과 고정 길이 기반의 Aggregator가 기본적으로 존재한다.
    - `DelimitedLineAggregator`
    - `FormatterLineAggregator`
- `LineAggregator.aggregate()` 내부에서 `FieldExtractor`를 사용하는 구조기에 두 컴포넌트 모두 `T` 타입 객체를 파라미터로 받는다.
    - `LineAggregator`를 구현한 `ExtractorLineAggregator` 추상 클래스 내부에서 `FieldExtractor`를 사용한다.
    - `DelimitedLineAggregator`, `FormatterLineAggregator`은 `ExtractorLineAggregator`를 구현한다.
