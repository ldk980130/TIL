# ItemStream

- 앞서 다룬 `ItemReader`, `ItemWriter`들 중에선 실제 데이터 처리를 다른 컴포넌트에게 위임하는 것들이 있었다.
    - `MultiResourceItemReader`**,** `MultiResourceItemWriter`**,** `CompositeItemReader`**,** `CompositeItemWriter`
- 각 위임자 내부 코드엔 `delegate` 필드가 존재한다.

```java
// MultiResourceItemReader
private ResourceAwareItemReaderItemStream<? extends T> delegate;

// MultiResourceItemWriter
private ResourceAwareItemWriterItemStream<? super T> delegate;

// CompositeItemReader
private final List<ItemStreamReader<? extends T>> delegates;
```

- 위임 대상들은 모두 단순 `ItemReader`/`ItemWriter`가 아닌 `ItemStream`을 사용하고 있다.
- 실제로 Spring Batch 대부분의 구현체들은 `ItemStream` 인터페이스를 공통적으로 구현하고 있다.
    - 대부분의 `ItemReader`는 `ItemStream`
    - 하지만 `ItemWriter`의 경우 파일 기반 구현체를 제외하고는 대부분 `ItemStream`이 아니다.

```java
public interface ItemStream {
    default void open(ExecutionContext executionContext) throws ItemStreamException {}
	
    default void update(ExecutionContext executionContext) throws ItemStreamException {}
	
    default void close() throws ItemStreamException {}
}
```

## ItemStream의 역할

- `ItemStream`은 다음 두 역할을 담당한다.
    - 자원 초기화 및 해제
    - 메타데이터 관리 및 상태 추적
