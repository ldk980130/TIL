# 잡 파미터와 스프링 배치 Scope

- `JobParameters`는 배치 작업에 전달되는 입력 값이다.
    - 어떤 조건에서, 어떤 데이터를 다룰 것인가
    - ex) 매일 실행되는 배치의 경우 날짜나 실행 경로 등 매번 바뀐다.
- 즉 `JobParameters`는 배치 잡을 동적이고 유연하게 만들어 준다.

## 프로퍼티와 JobParameters 차이

- -D 옵션 으로 실행 시 파라미터를 주입할 수도 있지만 `JobParameters`와 그 목적이 다르다.

### 입력값 동적 변경

- -D 옵션 프로퍼티는 앱 시작 시 주입되는 정적인 값이다.
- `JobParameters`로는 웹 요청이 들어올 때마다 비동기 배치로 매번 다른 파라미터를 동적으로 전달할 수 있다.

### 메타데이터

- 스프링 배치에선 JobParameters의 모든 값을 메타데이터 저장소에 기록한다.
- 이를 통해 다음을 제공한다.
    - `Job` 인스턴스 식별 및 재시작 처리
    - `Job` 실행 이력 추적

## JobParameters 전달하기

- 실제 운영 환경에선 커맨드 라인을 통해 파라미터를 전달하는 방식이 핵심이다.
    - 젠킨스와 같은 CI/CD 도구 등 대부분 스케줄러 도그는 커맨드라인 실행을 기본으로 지원
    - ex) `./gradlew bootRun --args='--spring.batch.job.name=dataProcessingJob inputFilePath=/data/input/users.csv,java.lang.String’`
    - `—spring.batch.job.name`은 `Job`의 이름을 지정, 그 뒤의 key, value들이 실제 `JobParameters`다.

### JobParameters 기본 표기법

```bash
parameterName=parameterValue,parameterType,identificationFlag
```

- `parameterName`: Job에서 파라미터를 찾을 때 사용하는 key 값
- `parameterValue`: 파라미터의 실제 값
- `parameterType`: 파라미터의 타입으로 명시하지 않으면 `String`으로 가정한다.
    - `java.lang.String`와 같은 fully qualified name 사용
    - 스프링 배치의 `DefaultJobParametersConverter` 컴포넌트를 통해 적절한 타입으로 변환된다.
- `indentificationFlag`: 스프링 배치에게 해당 파라미터가 `JobInstance` 식별에 사용되는지 여부를 전달
    - 생략 가능하며 생략하면 `true`로 설정된다.

