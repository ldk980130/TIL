# Spring Batch Listener와 활용

- 리스너는 배치 처리 중 발생하는 특정 이벤트를 감지하고 동작을 정의할 수 있게 해준다.
    - 이를 통해 로깅, 모니터링, 에러 처리 등을 수행할 수 있다.

## JobExecutionListener

- `Job` 실행의 시작과 종료 시점에 호출되는 리스너 인터페이스
- `afterJob`
    - `Job` 실행 정보가 메타데이터에 저장되기 전에 호출된다.
    - 특정 조건에 따라 `Job` 실행 결과 상태를 완료(`COMPLETED`)에서 실패(`FAILED`)로 변경하거나 반대도 가능

```java
public interface JobExecutionListener {
    default void beforeJob(JobExecution jobExecution) { }
    default void afterJob(JobExecution jobExecution) { }
}
```

## StepExecutionListener

- `Step` 실행의 시작과 종료 시점에 호출되는 리스너 인터페이스

```java
public interface StepExecutionListener extends StepListener {
    default void beforeStep(StepExecution stepExecution) { }

    @Nullable
    default ExitStatus afterStep(StepExecution stepExecution) {
			return null;
    }
}
```

- `afterStep`에서의 `ExitStatus` 반환을 통해 `Step` 실행 결과 상태를 직접 변경 가능하다.

## ChunkListener

- 하나의 청크 단위 처리가 시작되기 전/후 그리고 에러 발생 시 호출되는 리스너 인터페이스

```java
public interface ChunkListener extends StepListener {
    default void beforeChunk(ChunkContext context) { }

    default void afterChunk(ChunkContext context) { }
	
    default void afterChunkError(ChunkContext context) { }
}
```

- `afterChunk`는 트랜잭션 커밋 후 호출된다.
- `afterChunkErrror`는 트랜잭션 롤백 이후 호출된다.

