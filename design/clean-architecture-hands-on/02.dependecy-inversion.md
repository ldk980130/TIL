# 02. 의존성 역전하기

## 단일 책임 원칙

> 하나의 컴포넌트는 오로지 한 가지 일만 해야 하고, 그것을 올바르게 수행해야 한다.
>
- ‘단일 책임 원칙’은 위와 같은 정의로 알고 있을텐데 실제 정의는 아래와 같다.

> 컴포넌트를 변경하는 이유는 오직 하나뿐이어야 한다.
>
- ‘책임’은 ‘한 가지 일만 하는 것’보단 ‘변경할 이유’로 해석해야 한다.
- 만약 컴포넌트를 변경할 이유가 한 가지라면 어떤 다른 이유로 소프트웨어를 변경하더라도 이 컴포넌트에 대해 신경 쓸 필요가 전혀 없다.
- 하지만 ‘변경할 이유’는 컴포넌트 간 의존성을 통해 너무 쉽게 전파된다.
    - 아무것도 의존하고 있지 않은 컴포넌트는 자신의 ‘변경할 이유’에만 신경쓰면 된다.
    - 다른 많은 컴포넌트를 의존하고 있는 컴포넌트는 다른 컴포넌트들의 ‘변경할 이유’에 영향 받아 함께 변경되어야 한다.
    - 시간이 지날수록 컴포넌트를 변경할 더 많은 이유가 쌓이게 된다.

## 부수 효과에 관한 이야기

- 한 컴포넌트가 의존하고 있는 다른 컴포넌트의 변경에 영향을 받아 나타나는 일을 ‘부수효과’라고 한다.
- 복잡한 소프트웨어에선 핵심 컴포넌트의 변경으로 발생할 ‘부수효과’ 때문에 소프트웨어 변경을 두려워하는 일이 많다.
- 즉 잘못 구조화된 소프트웨어를 변경하는 데는 많은 비용이 지불된다.

## 의존성 역전 원칙

- 계층형 아키텍처에서 계층 간 의존성은 항상 다음 계층인 아래 방향을 가리킨다.
    - 웹 → 도메인 → 영속성
- 때문에 영속성 계층을 변경할 때 잠재적으로 도메인 계층도 변경해야 한다.
    - 영속성 코드가 변경되어도 도메인 코드는 바꾸고 싶지 않다.
- 의존성 역전을 사용하면 의존성의 방향을 역전시킬 수 있다.
    - 영속성 코드가 도메인에 의존하도록 하여 도메인의 ‘변경할 이유’를 줄이는 것

      ![image](https://github.com/ldk980130/TIL/assets/78652144/420a8d69-bf6a-432d-b0e0-ea4ce25aeae9)

    - 도메인에 있는 엔티티와 ORM에서 사용하는 엔티티를 분리하고 리포지터리는 인터페이스를 사용해서 의존성을 역전시킨다.
