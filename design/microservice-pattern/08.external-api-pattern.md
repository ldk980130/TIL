# 8장 외부 API 패턴
## 8.1 외부 API 설계 이슈

- FTGO 애플리케이션의 서비스 API를 소비하는 네 종류의 클라이언트
    - 브라우저 기반 일반 소비자 및 음식점 전용 UI, 내부 관리자용 UI가 구현된 웹 애플리케이션
    - 브라우저에서 실행 중인 자바스크립트 애플리케이션
    - 소비자용/배달원용 모바일 앱
    - 서드파티 애플리케이션
- FTGO 애플리케이션의 서비스와 클라이언트, 일부 클라이언트는 방화벽 내부, 나머지는 외부에 위치한다.
    - 방화벽 외부에서의 서비스 호출은 방화벽 내부에서의 LAN을 통한 접근보다 느리다.

### 8.1.1 API 설계 이슈: FTGO 모바일 클라이언트

- FTGO에선 모바일 클라이언트를 통해 주문을 하고 이력을 관리한다.
- 클라이언트가 요청을 여러 번 전송하기 때문에 UX가 나빠진다.
    - 일반적으로 네트워크 지연 시간은 LAN보다 100배는 더 길다.
    - 동시에 요청을 실행한다면 지연이 짧을 수도 있지만 순차적인 요청이 필요하다면 지연이 길어질 것이다.
    - UX도 문제지만 복잡한 API 조합 코드를 작성할 일이 많아지는 것도 문제
    - 요청 횟수가 늘어날수록 모바일 기기 배터리 소모도 빠를 것이다.
- 캡슐화가 되지 않아 프런트 개발자가 백엔드와 맞물려 코드를 변경해야 한다.
    - 서비스에 관한 지식이 앱 클라이언트에 포함되어 있으면 API를 변경하기 아주 곤란해진다.
- 클라이언트가 비친화적인 IPC를 사용 중인 클라이언트도 있다.
    - HTTP, 웹 소켓 외에도 gRPC, AMQP 등의 프로토콜을 사용할 수 있는데 이는 모바일에서 소비하기 어려운 경우가 많다.

### 8.1.2 API 설계 이슈: 다른 종류의 클라이언트

- 웹 애플리케이션
    - 전통적 웹 애플리케이션은 브라우저에서 HTTP 요청을 받아 HTML 페이지를 반환한다.
    - 방화벽 내부에서 LAN을 통해 서비스에 접근하기에 API 조합으로 인한 네트워크 지연은 큰 장애물이 아니다.
    - 웹 애플리케이션은 웹 비친화적인 프로토콜로도 서비스에 접근 가능하다.
    - 개발 팀이 같은 조직에서 백/프론터 개발자가 긴밀한 협업을 하기에 변경도 어렵지 않다.
- 브라우저 기반의 자바스크립트 애플리케이션
    - 요즘 브라우저 애플리케이션은 브라우저에서 실행되는 자바스크립트 코드가 서비스를 호출한다.
    - 브라우저 기반 애플리케이션은 서비스 API 변경 시 업데이트하기는 휩다.
    - 다만 API 조합으로 인한 네트워크 지연은 장애물이 된다.
- 서드파티 애플리케이션
    - 외부 개발자들은 서드파티 API를 응용해 주문 관리 애플리케이션을 개발할 수 있다.
    - 서드파티 개발자에게는 안정된 API가 필요하기에 구 버전을 오래 유지하는 경우도 흔하다.
        - 아무리 잘나가는 회사라도 서드파티 개발자에게 새 API로 업그레이드하라고 강요할 수 없다.
        - 경쟁사에게 개발자를 뺏길 수도 있기에
    - 서드파티 개발자에게 직접 서비스를 표출하는 대신 별도 팀에서 개발한 퍼블릭 API를 따로 가져가는 것이 좋다.
