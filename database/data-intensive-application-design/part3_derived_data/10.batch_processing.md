# 10장 일괄 처리
- 시스템의 세 가지 유형
    - 서비스(온라인 시스템)
        - 클라이언트의 요청이 오면 응답
        - 서비스 성능을 측정하는 중요한 지표는 응답 시간이다.
    - 일괄 처리 시스템 (오프라인 시스템)
        - 매우 큰 입력 데이터를 받아 처리 후 결과 데이터를 생성
        - 오랜 시간이 걸리기에 사용자가 작업이 끝날 때까지 대기하지 않는다.
        - 대부분 하루에 한 번 수행과 같이 반복적 일정으로 수행한다.
        - 주요 성능 지표로는 처리량이 대표적이다.
    - 스트림 처리 시스템 (준실시간 시스템)
        - 정해진 입력을 처리하는 일괄 처리와 달리 입력 이벤트가 발생한 직후 입력 데이터를 소비해 출력 데이터를 생성
        - 일괄 처리 시스템보다 지연이 낮다.

## 유닉스 도구로 일괄 처리하기

### 단순 로그 분석

- 유닉스 도구를 사용해 웹서버 로그 중 가장 인기 있는 페이지 5개를 추출한다고 가정해보자.
- 아래 파이프라인은 로그 파일을 읽고 URL을 추출, 정렬, 중복을 제거하여 카운트한 뒤 다시 정렬해 상위 5개를 추출한다.

```bash
cat /var/log/nginx/access.log |
awk '{print $7}' |
sort |
uniq -c |
sort -r -n |
head -n 5
```

- 유닉스에 익숙하지 않다면 이해하기 어려운 명령어이지만 상당히 강력한 일괄 처리를 제공한다.
    - 수 기가바이트의 로그 파일을 수 초내로 처리 가능
    - 필요에 따라 분석 방법을 수정하기도 쉽다.

### 유닉스 철학

- 유닉스 철학의 주요 원칙은 다음과 같다.
    - 각 프로그램이 한 가지 일만 하도록 작성한다.
    - 모든 프로그램의 출력은 아직 알려지지 않은 다른 프로그램의 입력으로 사용할 수 있어야 한다.
    - 소프트웨어를 빠르게 써볼 수 있게 설계하고 구축하라
    - 프로그래밍 작업을 줄이려면 미숙한 도움보단 도구를 사용하라
- bash 같은 유닉스 셸을 통해 놀랄만큼 강력한 데이터 처리 작업을 쉽게 구성할 수 있다.
- 유닉스 도구의 특징
    - 동일 인터페이스
        - 파일 디스크립터를 통해 모든 프로그램이 동일 입출력 인터페이스를 사용
    - 로직과 연결의 분리
        - 프로그램이 입력의 출처나 출력의 목적지를 신경 쓰지 않아도 된다.
        - 이는 느슨한 결합, 지연 바인딩, 제어 반전의 개념을 구현한다.
    - 투명성과 실험
        - 진행 상황을 파악하기 쉽고 중간 결과를 확인 가능
        - 즉 실험과 디버깅이 용이하다.
- 유닉스 도구의 가장 큰 제약은 단일 장비에서만 실행된다는 점이다.
    - 이를 극복하기 위해 하둡 같은 도구가 개발되었다.
