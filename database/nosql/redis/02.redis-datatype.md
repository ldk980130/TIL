# 02. Redis data types

## Redis data types

ë ˆë””ìŠ¤ëŠ” ìºì‹±, íì‰, ì´ë²¤íŠ¸ ì²˜ë¦¬ ë“±ì˜ ë‹¤ì–‘í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” Collectionì„ ì œê³µí•œë‹¤.

### Strings

- ì¼ë°˜ì ì¸ ë¬¸ìì—´
- ìµœëŒ€ 512MB
- binary data, JPEG ì´ë¯¸ì§€ë„ ì €ì¥ ê°€ëŠ¥í•˜ë‹¤.
- ë‹¨ìˆœ ì¦ê° ì—°ì‚°ì— ì¢‹ìŒ
- ëŒ€ë¶€ë¶„ì˜ ì—°ì‚°ì€ O(1)ì´ì§€ë§Œ `SUBSTR`, `GETRANGE`, `SETRANGE` ëª…ë ¹ì€ O(n)ì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì„±ëŠ¥ì— ì£¼ì˜í•´ì•¼ í•œë‹¤.
- ê¸°ë³¸ ëª…ë ¹ì–´
    - `SET`: ë°ì´í„° ì €ì¥, keyê°€ ìˆìœ¼ë©´ ë®ì–´ì“´ë‹¤. (`set keyName â€œvalueâ€`)
    - `SETNX`: ì§€ì •í•œ keyê°€ ì—†ì„ ê²½ìš°ì—ë§Œ ë°ì´í„° ì €ì¥
    - `GET`: ë°ì´í„° ì¡°íšŒ (`get keyName`)
    - `MGET`: ì—¬ëŸ¬ ê°œì˜ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ì¡°íšŒ `(mget keyName1 keyName2`)

### Lists

- ë°°ì—´ í˜•ì‹ì˜ ë°ì´í„° êµ¬ì¡°, ìˆœì„œëŒ€ë¡œ ì €ì¥
- ì¶”ê°€, ì‚­ì œ, ì¡°íšŒëŠ” O(1)ì´ì§€ë§Œ ì¤‘ê°„ì˜ íŠ¹ì • index ê°’ì„ ì¡°íšŒí•  ë•ŒëŠ” O(n) ì†ë„ë¥¼ ê°€ì§„ë‹¤.
    - ì¦‰ ì¤‘ê°„ ê°’ì˜ ì¶”ê°€, ì‚­ì œê°€ ëŠë¦¬ë‹¤.
- ìŠ¤íƒ ë° í êµ¬í˜„ì´ë‚˜ ë°±ê·¸ë¼ìš´ë“œ ì›Œì»¤ ì‹œìŠ¤í…œì„ ìœ„í•œ í ê´€ë¦¬ êµ¬ì¶•ì— ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.
- ë¦¬ìŠ¤íŠ¸ ìµœëŒ€ ê¸¸ì´ëŠ” 2^32 - 1
- ê¸°ë³¸ ëª…ë ¹ì–´
    - `LPUSH`: ë¦¬ìŠ¤íŠ¸ì˜ ì•ë¶€ë¶„ì— ìƒˆ ìš”ì†Œë¥¼ ì¶”ê°€ (`LPUSH myList â€œaâ€`)
    - `LPOP`: ë¦¬ìŠ¤íŠ¸ ì™¼ìª½ì—ë” ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê³  ì‚­ì œ (`LPOP myList`)
    - `LLEN`: ë¦¬ìŠ¤íŠ¸ ìš”ì†Œ ì´ ê°œìˆ˜ ì¡°íšŒ
    - `LMOVE`: ë¦¬ìŠ¤íŠ¸ ê°„ ë°ì´í„° ì´ë™
    - `LTRIM`: ì¸ë±ìŠ¤ë¡œ ì§€ì •í•œ ë²”ìœ„ ë°–ì˜ ê°’ë“¤ì„ ì‚­ì œ

### Sets

- ì¤‘ë³µëœ ë°ì´í„°ë¥¼ ë‹´ì§€ ì•Šê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ìë£Œêµ¬ì¡°
- ìœ ë‹ˆí¬í•œ key ê°’
    - í•œ keyì— ì—¬ëŸ¬ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ê°’ë“¤ì„ ì‚½ì…í•  ìˆ˜ ìˆë‹¤.
- IP ê°™ì€ ê³ ìœ  í•­ëª© ì¶”ì ì— ìš©ì´
- êµì§‘í•©, í•©ì§‘í•©, ì°¨ì§‘í•© ë“± ì¼ë°˜ì ì¸ ì§‘í•© ì—°ì‚° ìˆ˜í–‰
- ì§‘í•© ìµœëŒ€ í¬ê¸°ëŠ” 2^32 - 1ê°œì˜ ìš”ì†Œ
- ê¸°ë³¸ ëª…ë ¹ì–´
    - `SADD`: ì§‘í•©ì— ìƒˆ ë©¤ë²„ ì¶”ê°€ (`sadd mySet a`)
    - `SREM`: íŠ¹ì • ë©¤ë²„ë¥¼ ì‚­ì œ (`srem mySet a`)
    - `SISMEMBER`: ì§‘í•©ì— ë©¤ë²„ê°€ ìˆëŠ”ì§€ í™•ì¸ (`sismember mySet a`)
    - `SINTER`: êµì§‘í•©ì„ êµ¬í•¨
    - `SCARD`: ì§‘í•©ì˜ ë©¤ë²„ ê°œìˆ˜ ì¡°íšŒ
- ê¸°ë³¸ì ìœ¼ë¡œ ì„±ëŠ¥ì€ O(1)ì´ì§€ë§Œ `SMEMBERS` ëª…ë ¹ì€ ëª¨ë“  ì§‘í•© ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸°ì— O(n)ì´ë¯€ë¡œ ì£¼ì˜í•´ì•¼ í•œë‹¤.

### Hashes

- field-valueë¡œ êµ¬ì„±ëœ ì „í˜•ì ì¸ hash í˜•íƒœ
- key í•˜ìœ„ì— subkeyë¥¼ ì´ìš©í•´ ì¶”ê°€ì ì¸ Hash Tableì„ ì œê³µí•˜ëŠ” ìë£Œêµ¬ì¡°
- ë©”ëª¨ë¦¬ê°€ í—ˆìš©í•˜ëŠ” í•œ ì œí•œ ì—†ì´ field ì¶”ê°€ ê°€ëŠ¥
- ê¸°ë³¸ ëª…ë ¹ì–´
  - HSET: fieldì™€ valueë¥¼ ì €ì¥ (`hset key field value`)
  - HGET: fieldë¡œ valueë¥¼ ì¡°íšŒ (`hget key field`)
    HMGET:  ì—¬ëŸ¬ê°œì˜ valueë¥¼ ì¡°íšŒ
  - HINCRBY: valueë¥¼ incementë§Œí¼ ì¦ê°€ ë˜ëŠ” ê°ì†Œ (`hincrby key field increment`)

```bash
> HSET user:123 username martina firstName Martina lastName Elisa country GB
(integer) 4
> HGET user:123 username
"martina"
> HGETALL user:123
1) "username"
2) "martina"
3) "firstName"
4) "Martina"
5) "lastName"
6) "Elisa"
7) "country"
8) "GB"
```

- ëŒ€ë¶€ë¶„ì˜ ëª…ë ¹ì–´ëŠ” O(1)ì´ì§€ë§Œ `HKEYS`, `HVALS`, `HGETALL` ë“±ì˜ ëª…ë ¹ì–´ëŠ” O(n)ì´ë©° ì—¬ê¸°ì„œ nì€ field-value ìŒì˜ ìˆ˜ì´ë‹¤.

### Sorted sets

- setì— scoreë¼ëŠ” í•„ë“œê°€ ì¶”ê°€ëœ ìë£Œêµ¬ì¡°
- setì˜ íŠ¹ì„±ì„ ê·¸ëŒ€ë¡œ ê°€ì§€ë©° ì¶”ê°€ì ìœ¼ë¡œ ì •ë ¬ëœ ìƒíƒœë¡œ ê´€ë¦¬í•œë‹¤.
  - score ìˆœìœ¼ë¡œ
- valueëŠ” ì¤‘ë³µ ë¶ˆê°€ëŠ¥, scoreëŠ” ì¤‘ë³µ ê°€ëŠ¥
- scoreê°€ ê°™ìœ¼ë©´ ì‚¬ì „ ìˆœ ì •ë ¬
- ì‚¬ìš© ì˜ˆ
  - ë¦¬ë” ë³´ë“œ (ëŒ€ê·œëª¨ ì˜¨ë¼ì¸ ê²Œì„ì—ì„œ ìµœê³  ì ìˆ˜ ëª©ë¡ì„ ì‰½ê²Œ ì •ë ¬í•˜ì—¬ ê´€ë¦¬)
  - ì†ë„ ì œí•œ (ê³¼ë„í•œ API ìš”ì²­ ë°©ì§€)
- ê¸°ë³¸ ëª…ë ¹ì–´
  - `ZADD`: ì§‘í•©ì— scoreì™€ member ì¶”ê°€ (`zadd key score member`)
  - `ZRANGE`: indexë¡œ ë²”ìœ„ë¥¼ ì§€ì •í•˜ì—¬ ì¡°íšŒ
  - `ZRANK`: ì˜¤ë¦„ì°¨ìˆœ ê¸°ì¤€ memberë¥¼ ì§€ì •í•´ì„œ rank(index) ì¡°íšŒ (`zrank key member`)
  - `ZREVRANK`: ë‚´ë¦¼ì°¨ìˆœ ê¸°ì¤€ memberë¥¼ ì§€ì •í•´ì„œ reverse rank ì¡°íšŒ

```bash
> ZADD leaderboard:455 100 user:1
(integer) 1
> ZADD leaderboard:455 75 user:2
(integer) 1
> ZADD leaderboard:455 101 user:3
(integer) 1
> ZADD leaderboard:455 15 user:4
(integer) 1
> ZADD leaderboard:455 275 user:2
(integer) 0

> ZRANGE leaderboard:455 0 2 REV WITHSCORES
1) "user:2"
2) "275"
3) "user:3"
4) "101"
5) "user:1"
6) "100"

> ZREVRANK leaderboard:455 user:2
(integer) 0
```

- member ìˆ˜ê°€ nì¼ ë•Œ ëŒ€ë¶€ë¶„ ì—°ì‚°ì€ O(log(n))
  - ë°˜í™˜ ê°’ì´ í° ê²½ìš°(ìˆ˜ë§Œ ê°œ ì´ìƒ)ì—ëŠ” ZRANGE ëª…ë ¹ ì‹¤í–‰ ì‹œ ì£¼ì˜í•´ì•¼ í•œë‹¤. (ë³µì¡ë„ê°€ O(log(n) + m)ì´ë©° mì€ ë°˜í™˜ë˜ëŠ” ê²°ê³¼ ìˆ˜)

### Streams

- logë¥¼ ì €ì¥í•˜ê¸° ì¢‹ì€ ìë£Œêµ¬ì¡°
- append-onlyë¡œ ì¤‘ê°„ì— ë°ì´í„°ê°€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.
- id ê°’ ê¸°ë°˜ ì‹œê°„ ë²”ìœ„ë¡œ ê²€ìƒ‰
  - streamì€ ê° í•­ëª©ì— ëŒ€í•´ ê³ ìœ  idë¥¼ ìƒì„±
- ì´ë²¤íŠ¸ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê¸°ë¡
- ê¸°ë³¸ ëª…ë ¹ì–´
  - `XADD`: streamì— ìƒˆ í•­ëª© ì¶”ê°€
  - `XREAD`: í•˜ë‚˜ ë˜ëŠ” ê·¸ ì´ìƒì˜ í•­ëª©ì„ ì‹œê°„ ìˆœ ì¡°íšŒ
  - `XRANGE`: ì£¼ì–´ì§„ ë‘ ID ì‚¬ì´ì˜ í•­ëª©ë“¤ì„ ì¡°íšŒ
  - `XLEN`: í•­ëª© ê¸¸ì´
- streamì— í•­ëª©ì„ ì¶”ê°€í•˜ëŠ” ì‹œê°„ì€ O(1)ì´ì§€ë§Œ ë‹¨ì¼ í•­ëª©ì— ì ‘ê·¼í•˜ëŠ” ë°ëŠ” O(n)ì´ ì†Œìš”
  - nì€ stream IDì˜ ê¸¸ì´ì´ê³  ì¼ë°˜ì ìœ¼ë¡œ ì§§ê³  ê¸¸ì´ê°€ ê³ ì •ë˜ì–´ ìˆë‹¤. ì¦‰ íš¨ìœ¨ì ì¸ ì‚½ì…ê³¼ ì½ê¸°ë¥¼ ì œê³µí•œë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.

### ****Geospatial indexes****

- Redis ì§€ë¦¬ ê³µê°„ ìë£Œêµ¬ì¡°
- ì§€ë¦¬ì  ê³µê°„ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¢Œí‘œë¥¼ ì €ì¥í•˜ê³  ê²€ìƒ‰í•  ìˆ˜ ìˆë‹¤.
- ì§€ì ëœ ë°˜ê²½ ë˜ëŠ” ê²½ê³„ ë°•ìŠ¤ ë‚´ì— ê°€ê¹Œìš´ ì§€ì ì„ ì°¾ëŠ” ë° ìœ ìš©í•˜ë‹¤.
- ê¸°ë³¸ ëª…ë ¹ì–´
  - `GEOADD`: ì§€ì •ëœ ì§€ë¦¬ ê³µê°„ ì¸ë±ìŠ¤ì— ìœ„ì¹˜ë¥¼ ì¶”ê°€ (ìœ„ë„ë³´ë‹¤ ê²½ë„ ë¨¼ì €)
  - `GEOSEARCH`: ì§€ì •ëœ ë°˜ê²½ ë˜ëŠ” ê²½ê³„ ë°•ìŠ¤ê°€ ìˆëŠ” ìœ„ì¹˜ ë°˜í™˜

```bash
> GEOADD locations:ca -122.27652 37.805186 station:1
(integer) 1
> GEOADD locations:ca -122.2674626 37.8062344 station:2
(integer) 1
> GEOADD locations:ca -122.2469854 37.8104049 station:3
(integer) 1

> GEOSEARCH locations:ca FROMLONLAT -122.2612767 37.7936847 BYRADIUS 5 km WITHDIST
1) 1) "station:1"
   2) "1.8523"
2) 1) "station:2"
   2) "1.4979"
3) 1) "station:3"
   2) "2.2441"
```

### Bitmaps

- bitmasì€ stringì˜ ë³€í˜•ìœ¼ë¡œ ë¬¸ìì—´ì„ ë¹„íŠ¸ ë°±í„°ì²˜ëŸ¼ ì·¨ê¸‰í•  ìˆ˜ ìˆë‹¤.
- bit ë‹¨ìœ„ ì—°ì‚° ê°€ëŠ¥
- 2^32bitê¹Œì§€ ì‚¬ìš© ê°€ëŠ¥
- ì €ì¥ ê³µê°„ ì ˆì•½ì— í° ì¥ì 
- ê¸°ë³¸ ëª…ë ¹ì–´
  - `SETBIT`: bit ê°’ ì¡°ì •
  - `GETBIT`: bit ê°’ ì¡°íšŒ
  - `BITOP`: bit ì—°ì‚° (AND, OR, XOR, NOT) ì‹¤í–‰
- `BITOP`ì€ O(n)ì´ê³  ë‚˜ë¨¸ì§€ëŠ” O(1)

```bash
> SETBIT pings:2024-01-01-00:00 123 1
(integer) 0

> GETBIT pings:2024-01-01-00:00 123
1

> GETBIT pings:2024-01-01-00:00 456
0
```

### Bitfields

- bitfieldë¥¼ ì‚¬ìš©í•˜ë©´ ì„ì˜ì˜ ë¹„íŠ¸ ê¸¸ì´ì—ì„œ ì •ìˆ˜ ê°’ì„ ì‚½ì…, ì¦ê°€, ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- ì´ ê°’ë“¤ì€ ë°”ì´ë„ˆë¦¬ ì¸ì½”ë”©ëœ Redis stringsë¥¼ ì‚¬ìš©í•˜ì—¬ ì €ì¥ëœë‹¤.
- bitfieldëŠ” ì›ìì  ì½ê¸°, ì“°ê¸°, ì¦ê°€ ì—°ì‚°ì„ ì§€ì›í•˜ë¯€ë¡œ ì¹´ìš´í„° ë° ìœ ì‚¬í•œ ìˆ«ì ê°’ì„ ê´€ë¦¬í•˜ëŠ”ë° ì í•©í•˜ë‹¤.
- ê¸°ë³¸ ëª…ë ¹ì–´
  - `BITFIELD`: í•˜ë‚˜ ì´ìƒì˜ ê°’ì„ ì›ìì ìœ¼ë¡œ ì„¤ì •í•˜ê³ , ì¦ê°€í•˜ê³ , ì½ëŠ”ë‹¤.
  - `BITFIELD_RO`: `BITFIELD`ì˜ read-only ë³€í˜•
- `BITFIELD`ëŠ” O(n)

### HyperLogLog

- ë§ì€ ì–‘ì˜ ë°ì´í„°ë¥¼ dumpí•  ë•Œ ì‚¬ìš©
- ì¤‘ë³µë˜ì§€ ì•Šì€ ëŒ€ìš©ëŸ‰ ë°ì´í„°ë¥¼ countí•  ë•Œ ì£¼ë¡œ ë§ì´ ì‚¬ìš© (0.81% ì˜¤ì°¨)
- setê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ ì €ì¥ë˜ëŠ” ìš©ëŸ‰ì´ ë§¤ìš° ì‘ë‹¤ (12kb ê³ ì •)
- ì €ì¥ëœ ë°ì´í„°ëŠ” ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ì—†ë‹¤. (ë°ì´í„° ë³´í˜¸)
- ex) ë°©ë¬¸ IP ê°œìˆ˜ ì¹´ìš´íŒ…, í¬ë¡¤ë§í•œ url ê°œìˆ˜, ê²€ìƒ‰í•œ ë‹¨ì–´ ê°œìˆ˜
- ê¸°ë³¸ ëª…ë ¹ì–´
  - `PFADD`: ì›ì†Œ ì¶”ê°€
  - `PFCOUNT`: ì›ì†Œ ê°œìˆ˜ ì¡°íšŒ
  - `PFMERGE`: ë‘ ê°œ ì´ìƒì˜ HyperLogLogsë¥¼ í•˜ë‚˜ë¡œ ê²°í•©
- ì“°ê¸°ì™€ ì½ê¸°ëŠ” ì¼ì •í•œ ì‹œê°„ê³¼ ê³µê°„ì—ì„œ ìˆ˜í–‰ë˜ì§€ë§Œ `PFMERGE`ëŠ” O(n)ì´ë‹¤.

```bash
> PFADD members 123
(integer) 1
> PFADD members 500
(integer) 1
> PFADD members 12
(integer) 1

> PFCOUNT members
(integer) 3
```

---

https://redis.io/docs/data-types/

[https://inpa.tistory.com/entry/REDIS-ğŸ“š-ë°ì´í„°-íƒ€ì…Collection-ì¢…ë¥˜-ì •ë¦¬](https://inpa.tistory.com/entry/REDIS-%F0%9F%93%9A-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%80%EC%9E%85Collection-%EC%A2%85%EB%A5%98-%EC%A0%95%EB%A6%AC)
